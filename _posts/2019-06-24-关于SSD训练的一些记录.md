---
layout:     post   				    # 使用的布局（不需要改）
title:      关于SSD训练的一些记录 				# 标题 
date:       2019-02-06 				# 时间
header-img: img/post-bg-2015.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - SSD
---

从2018年年中开始，我们就在使用ssd训练一些人脸检测相关的东西，过程中有遇到一些问题，在此简单记录一下。

## 关于SSD最为人脸检测器

> 其实说实话，SSD不是一个比较好的用来做人脸检测的模型，因为SSD本身的一些属性（主要是锚点的选择方式），会导致SSD不太能训练出一个通用的人脸检测器。所以说，如果你想找一个效果很好，而且对于各种图像尺寸通用性又比较强的人脸检测器的话，SSD不太可能会成为你的首选。当然这个只是我目前得到的结果，如果有同学有更好的训练方法可以指导，还望不吝赐教。

## SSD的一些资源

> <https://github.com/weiliu89/caffe/tree/ssd> 官方的SSD
> <https://github.com/amdegroot/ssd.pytorch> 基于pytorch的SSD实现，使用起来也比较方便，这个是我们使用过的

## SSD训练过程中的一些KEY

### 样本问题

> 在我们最初刚开始训练SSD的时候，并没有对于样本考虑太多，只是使用了很多公开的数据集图像进行了整合，然后就开始风风火火的进行了训练。直到后来效果一直不是很好的时候，目光开始转向样本。关于样本有以下几个方面需要注意：

1. 人脸检测的样本集一定要干净，如果有必要人工清洗会带来很大的好处。如果没有能力清洗，请使用已经被大家广泛使用的数据集，或者使用一个已经被证明的很强大的人脸检测器对数据集进行清洗。
2. 最开始的时候说到，因为SSD其实是一个强记忆的模型，因此prior_box的设计对于网络的影响特别大，一个好的prior_box对于效果的提升是很重要的。在原始论文里，prior_box的设置是通过数学公式计算得来的，我们实验之后发现对于不同的检测目标，这个设置并不是最优值。可以采用kmeans来得到，甚至你可以通过对数据集的处理来自己进行计算。
3. 这个KEY不知道应不应该归在样本里面，不过暂时先这么写吧。样本的分辨率是很多样的，那么不同分辨率的样本对于网络的训练会有什么影响呢？根据第二点，在训练SSD的过程中，最好能将训练集的分辨率控制的跟实际使用场景一致，这样操作也会提升检测器的效果。

### 网络的选择

> 实际使用的过程中，一般很少会使用VGG或者ResNet作为SSD的前期网络，所以一般会使用小一些的前期网络，MobileNet是一个不错的小型网络，关于MobileNet和SSD的训练，可以参考<https://github.com/chuanqi305/MobileNet-SSD>。

1. MobileNet整个网络的冗余性还是比较高，可以适当的尝试不同尺度的模型。
2. 关于SSD的引出层的，最好不要使用过多的1x1的网络，虽然可以减少计算量，但是不太容易获得context的信息，可以采用3x3的空间卷积来操作。
3. 在SSD的引出层，采用上采样加入空间context的信息，会对网络的提升有帮助。


